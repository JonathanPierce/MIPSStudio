<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>MIPS Studio Testbed</title>
    <script type="text/javascript" src="utils.js"></script>
    <script type="text/javascript" src="data.js"></script>
    <script type="text/javascript" src="text.js"></script>
    <script type="text/javascript" src="parser.js"></script>
</head>
<body>

<h2>MIPS Studio <button id="parse">PARSE</button></h2>
<textarea id="input" rows="12" cols="100" placeholder="MIPS goes here..."></textarea><br/><hr/>
<div id="results">Enter some MIPS assembly in the box above, then hit 'PARSE'.</div>


<script type="text/javascript">
    document.getElementById('parse').addEventListener('click', function () {
        var input = document.getElementById('input').value;
        var div = document.getElementById('results');
        div.innerHTML = "";
        var result = MIPSParser.parse(input);

        // Did we error?
        if(result.error) {
            div.innerHTML = "<h1 style='color: red'>ERROR!</h1><b>Code:</b> " + ((result.code || result.code === 0) ? result.code : "None") + "<br/><b>Message: </b>" + result.message;
            return;
        }

        // Draw the results
        var output = "";
        output += "<h1 style='color: green'>Success!</h1>";
        output += "<h3>Constants:</h3>";

        // Draw the constants
        for (member in result.constants) {
            if (result.constants.hasOwnProperty(member)) {
                output += member + ": " + result.constants[member] + "<br/>";
            }
        }

        // Draw the instrucitons
        output += "<h3>Instructions</h3>";
        for (member in result.text) {
            if (result.text.hasOwnProperty(member)) {
                output += member + ": " + result.text[member].inst + " " + result.text[member].args.join(" ") + "<br/>";
            }
        }

        // Draw the data segment
        output += "<h3>Data:</h3>";
        output += JSON.stringify(result.data).replace(/[\{\}"]/g, "").split(",").join("\n");

        // Show the result
        div.innerHTML = output;
    });
</script>

</body>
</html>